{% extends 'base.html' %}
{% block content %}
<body class="bg-gray-100 dark:text-steel text-[#222222]">
    <!-- Blog Post Wrapper -->
    <div class="max-w-screen-md px-4 py-8 mx-auto">
        <!-- Thinner Centered Bar -->
        <div class="dark:bg-[#444444] bg-[#CCCCCC] rounded-3xl shadow-2xl dark:shadow-white p-6 mx-auto">
            <!-- Title Section -->
            <div class="text-center">
                <h1 class="text-6xl font-extrabold leading-tight text-cs-green">
                    Lab 1: Getting Started
                </h1>
                <h2 class="text-2xl text-bold leading-tight text-cs-green">
                    Red Pitaya Setup and Hello World!
                </h1>
                 <!-- Separator -->
                <div class="h-px bg-cs-green my-6"></div>
                <a href="#overview" class="inline-block bg-cs-blue hover:bg-blue-700  hover:underline px-4 py-1 rounded-lg font-medium transition-all duration-300 border-[#333333] border">
                    Overview
                </a> >>
                <a href="#setup" class="inline-block bg-cs-blue hover:bg-blue-700 hover:underline px-4 py-1 rounded-lg font-medium transition-all duration-300 border-[#333333] border">
                    Setup
                </a> >>
                <a href="#instructions" class="inline-block bg-cs-blue hover:bg-blue-700 hover:underline px-4 py-1 rounded-lg font-medium transition-all duration-300 border-[#333333] border">
                    Instructions
                </a> >>
                <a href="#conclusion" class="inline-block bg-cs-blue hover:bg-blue-700 hover:underline px-4 py-1 rounded-lg font-medium transition-all duration-300 border-[#333333] border">
                    Conclusion
                </a> >>
                <a href="#code-given" class="inline-block bg-cs-blue hover:bg-blue-700 hover:underline px-4 py-1 rounded-lg font-medium transition-all duration-300 border-[#333333] border">
                    Code Given
                </a>
            </div>

            <!-- Separator -->
            <div class="h-px bg-cs-green my-6"></div>

            <!-- Blog Content -->
            <div class="prose prose-lg mx-auto dark:text-steel text-[#222222]">
                <h1 id="overview" class="text-4xl font-extrabold">Overview</h1>
                <br/>
                <p class="leading-relaxed text-lg">
                    Welcome to Lab 1! Here, you will learn how to set up your red pitaya, connect to it using your laptop, and start writing some code. Luckily for you, this year all the red-pitayas will be given to you pre-assembled, which cuts down on the time-commitment of this lab. Remember that this online guide is for your convenience, but is not comprehensive and should not be used as a replacement for the official lab guide, which you can download above. If you find any errors in this guide—whether logic, spelling, or grammar—please let TA Cooper know so he can get it fixed up ASAP.
                </p>
                <!-- Separator -->
                <div class="h-px bg-cs-green my-6"></div>

                <h1 id="setup" class="text-4xl font-extrabold">Red Pitaya Setup</h1>
                <br/>
                <h1 class="text-2xl text-bold underline text-cs-green">Physical Setup</h1>
                <p class="leading-relaxed text-lg">
                    For the physical red pitaya, make sure you have done these things:
                </p>
                <br/>
                <ol class="list-decimal ml-16 text-lg">
                    <li>Place the microSD card into the slot, if it is not already in there.</li>
                    <li>Plug the ethernet cable from the pitaya to your computer (we will be passing out adapters at the beginning of the lab)</li>
                    <li>Provide power to the board with the microUSB port. There are 2 ports, so make sure you are using the PWR one (the one on the right).</li>
                </ol>
                <br/>
                <p class="leading-relaxed text-lg">
                    If you have completed these steps, you should see the light on the pitaya blinking green and occasionally red. This is normal.
                </p> 
                <br/>
                <h1 class="text-2xl text-bold underline text-cs-green">Virtual Setup</h1>
                <p class="leading-relaxed text-lg">
                    Now that your pitaya is all connected, we can make sure it is working digitally. To make sure you are connected properly, visit <code class="bg-cs-blue px-1 rounded shadow-lg text-base">http://rp-xxxxxx.local</code>  (replace the x's with the six digits on your red pitaya. It will be on your case, or the sticker with the QR code if the other one fell off). If you are connected properly, you should be brought to a website with a Red Pitaya logo in the background and some buttons. If the website times out, then something went wrong. See below for some troubleshooting tips.
                </p>
                <br/>
                <h1 class="text-2xl text-bold underline text-cs-green">Troubleshooting</h1>
                <ol class="list-decimal ml-6 text-lg">
                    <li>Double check the website name. It is case insensitive. You may also need to add a "/" at the end to connect (i.e. http://rp-xxxxxx.local/), but try it with and without the slash.</li>
                    <li>If you are using a VPN, you may need to disconnect from it to interact with the red pitaya.</li>
                    <li>Try flipping around the ethernet cord and/or the adapter. If you have a nearby friend who's device is working, try using their adapter and see if that is the issue.</li>
                    <li>If none of the above works, contact the nearest TA for assistance.</li>
                </ol>
                <br/>
                <h1 class="text-2xl text-bold underline text-cs-green">Connecting and Editing</h1>
                <p class="leading-relaxed text-lg">
                    To edit and create files on your red pitaya, we will be using something called Nano (or vim, if you choose to use that). We used to use VSCode to manage files on the pitaya, but recent updates have presented interfacing issues. Nano is also a good skill to learn, so consider it part of your learning experience.
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    If you are new to the terminal (which I expect most of you to be), I <b><u>highly</u></b> suggest you read through my <a href="/courses/conquering-the-terminal" class="text-lg text-cs-blue hover:text-blue-700 underline">Conquering the Terminal guide</a>. It is a short read and will teach you the basics of using the terminal and the 7 commands that you will need to be able to use in this class.
                </p>
                <br/>
                <ol class="list-decimal ml-6 text-lg space-y-2">
                    <li>Open "Terminal" if you are on Mac and "Powershell" if you are on Windows.</li>
                    <li>When it opens, type <code class="bg-cs-blue px-1 rounded shadow-lg text-base">ssh root@rp-xxxxxx.local</code> where "xxxxxx" is your pitaya number, and click enter.</li>
                    <li>It should prompt you for a password. It is <code class="bg-cs-blue0 px-1 rounded text-base">root</code>. <u> You won't see the letters you are typing in the command line. This is normal. Just type "root" and click enter.</u></li>
                    <li>You should now be connected to your red pitaya (you can check this by seeing what the beginning of the line in the terminal says. It should say "root:~ $" or something similar instead of your laptop name).</li>
                    <li>To create a file, type <code class="bg-cs-blue px-1 rounded shadow-lg text-base">touch main.s</code>. This creates a file called "main.s" in the current directory (a.k.a folder).</li>
                    <li>Type <code class="bg-cs-blue px-1 rounded shadow-lg text-base">nano main.s</code> to start editing an empty file named main.s. This is the Nano window. It is VERY confusing, even to experienced users. Here is a general overview of what you need to know:</li>
                </ol>
                <br/>
                <ol class="list-decimal ml-16 text-lg leading-relaxed space-y-2">
                    <li>You can type to enter text into a file and delete with the backspace key just like in a text editor.</li>
                    
                    <li>Some helpful commands are listed at the bottom. The "M-" means 'modifier', which varies depending on Mac vs Windows. I believe you can also hold down ESC and press the listed key for M- commands. You can also look up Nano commands if there is something specific you want to do.</li>
                    <li>You cannot use your mouse to select an area or move your cursor. You need to use arrow keys to move around.</li>
                    <li> To save, press Control+O (it is still Control on Mac, not Command). It will ask you for a file name, which should be filled as 'main.s' from your previous command. </li>
                    <li> When you are done editing, press Control+X to exit the editor. It may ask if you want to "save the modified buffer", which just means Save. Click Y to save.</li>
                    <li>Nano can be very confusing and overwhelming. If you get stuck or have questions, ask a TA. </li>
                </ol>
                <br/>
                <p class="leading-relaxed text-lg">
                    This should be everything you need to know to setup the Red Pitaya. If you encounter difficulty at any step, let the nearest TA know and we can help you through the process. <b>For the first lab, we will be prioritizing getting people's pitayas working. Please be patient if you have a coding question, as hardware errors are our primary concern.</b>
                </p>
                <!-- Separator -->
                <div class="h-px bg-cs-green my-6"></div>

                <h1 id="instructions" class="text-4xl font-extrabold">Lab Instructions</h1>
                <br/>
                <p class="leading-relaxed text-lg">
                    Welcome to Lab 1! Here, you will learn how to set up your red pitaya, connect to it using your laptop, and start writing some code. Luckily for you, this year all the red-pitayas will be given to you pre-assembled, which cuts down on the time-commitment of this lab.
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    This is out first semester using this website as a replacement for an pdf lab document (we made this update after 100% of previous students said they prefer the website instructions over the pdf). If you find any errors in this guide—whether logic, spelling, or grammar—please let TA Cooper know so he can get it fixed up ASAP. Expect new features to be added to this site in upcoming labs. I am writing this as of 8:33PM on Jan 22, 2025 for context.
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    For this lab, you will need "Raspberry Pi Assembly Language Programming by Stephen Smith" (referred to as the "Smith book"), which is required for this class. You need a copy of the book, either digital or physical. You can get the book for free on Pearson if you log in with your SMU email.
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    Now, read through chapter 1. You can skim until page 17, where you will be getting instructions for this lab.
                </p>
                <br/>
                <h1 class="text-2xl text-bold underline text-cs-green">Step 1</h1>
                <p class="leading-relaxed text-lg italic">
                    Code from the book can be found in the <a href="#code-given" class="text-lg text-cs-blue hover:text-blue-700 underline">Code Given</a> section at the bottom of this guide.
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    Type the code from the book into a new file called "HelloWorld.s" using Nano, as described above. Next, add the two lines from the book/Code Given into a file called "build". It should NOT have a filetype (i.e. .txt, .s, etc.). You can check to make sure all the files were created properly by typing <code class="bg-cs-blue px-1 rounded shadow-lg text-base">ls</code> into the terminal. This will list all the files in the current folder on your Red Pitaya. If you don't see "HelloWorld.s" and "build", ask a TA for assistance.
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    In your terminal (not in the Nano editor) type this command: <code class="bg-cs-blue px-1 rounded shadow-lg text-base">chmod +x build</code>. This command basically just tells the computer to transform the file "build" into an executable, or a file the computer can run. We can finally start executing some code. 
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    To compile your code, run <code class="bg-cs-blue px-1 rounded shadow-lg text-base">./build</code> in your terminal. This with create a new file called "HelloWorld" (namely different than "HelloWorld.s"). This is the code your computer can run. To run it, type <code class="bg-cs-blue px-1 rounded shadow-lg text-base">./HelloWorld</code> into your terminal. This should output the phrase "Hello World!" in the next line of your terminal. If it does not, ask a TA for assistance.
                </p>
                <br/>
                <h1 class="text-2xl text-bold underline text-cs-green">Step 2</h1>
                <p class="leading-relaxed text-lg">
                    Here, you need to edit the code using Nano to make it more personal. To do this, change the string at the bottom of "HelloWorld.s" (Not "HelloWorld" or "HelloWorld.o") to "Hello [Your Name Here]!". Remember that the red pitaya needs to know how many characters to write on the screen, so you will need to update the line <code class="bg-cs-blue px-1 rounded shadow-lg text-base">mov R2, #13   @ length of our string</code> to the new length of the string. Remember to include spaces, special characters, and the "\n" as a single character when counting.
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    To check that your program works, you will need to run it again. It is important to note that you must recompile your code <u>every time you make a change</u>. You can recompile using the command <code class="bg-cs-blue px-1 rounded shadow-lg text-base">./build</code>. Run your program again using <code class="bg-cs-blue px-1 rounded shadow-lg text-base">./HelloWorld</code>, which should output "Hello [Your Name]!"into the terminal. <u>Take a screenshot of the output, as well as your code, and make sure to include it in your lab report.</u>
                </p>
                <br/>
                <br/>
                <h1 class="text-2xl text-bold underline text-cs-green">Step 3</h1>
                <p class="leading-relaxed text-lg">
                    This next step is pretty simple. Go into HelloWorld.s and change the LAST <code class="bg-cs-blue px-1 rounded shadow-lg text-base">svc 0</code> to <code class="bg-cs-blue px-1 rounded shadow-lg text-base">svc AnyOtherNumber</code>. Where "AnyOtherNumber" is a number other than 0. Recompile your code and rerun it. What happened? <u>Take a screenshot of the output and write out what you saw happen in your own words.</u> If nothing happened, take note of that as well.
                </p>
                <!-- Separator -->
                <div class="h-px bg-cs-green my-6"></div>
                <h1 id="conclusion" class="text-4xl font-extrabold">Conclusion</h1>
                <br/>
                <p class="leading-relaxed text-lg">
                    Congrats! You just completed your first lab for ECE1181. All that's left to do now is to write your lab report and submit it sometime before your next lab session. Check the assignment on Canvas for more information about what to include in your lab report. Note that the first lab is often the longest of the semester, and you will often get out 1-2 hours early depending on how fast you work. 
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    You may have felt a little overwhelmed during this first session. That's okay. It may take a minute to settle into these concepts, but know that there are plenty of resources available to you if you are confused. See either Dr. Camp's office hours or preferably the TA office hours for help with labs, homework, or general questions about the course. We hope you have a great rest of your day and look forward to the next lab!
                </p>
                <!-- Separator -->
                <div class="h-px bg-cs-green my-6"></div>
                <h1 id="code-given" class="text-4xl font-extrabold">Code Given</h1>
                <br/>
                <p class="leading-relaxed text-lg">
                    Code is derived from Stephen Smith's Raspberry Pi Assembly Language Programming book, modified to fit the needs of this course. Credit belongs to the original author.
                </p>
                <br/>
                <p class="leading-relaxed text-lg">
                    WARNING: I strongly recommend typing this into your Red Pitaya directly. The reason is that there are hidden symbols that may cause a high degree of frustration from copy/paste that would be spared by just typing it in. Also, you get a better feel for the code in doing so. You will likely not understand all that is happening in this code for now. That is okay. As the semester goes on, you will gain an understanding of everything you see below.
                </p>
                <br/>
                <h1 class="text-2xl text-bold underline text-cs-green">build</h1>
                <pre class="dark:bg-gray-600 bg-gray-400 rounded-lg p-4 shadow-2xl overflow-auto">
as -o HelloWorld.o HelloWorld.s
ld -o HelloWorld HelloWorld.o</pre>
                <br/>
                <h1 class="text-2xl text-bold underline text-cs-green">HelloWorld.s</h1>
                <pre class="dark:bg-gray-600 bg-gray-400 rounded-lg p-4 shadow-2xl overflow-auto">
@ Assembler program to print "Hello World!"
@ to stdout.
@ R0-R2 - parameters to linux function services
@ R7 - linux function number

.global _start  @ Provide program starting @ address to linker
                @ Set up the parameters to print hello world
                @ and then call Linux to do it.
_start: 
    mov R0, #1          @ 1 = StdOut
    ldr R1, =helloworld @ string to print
    mov R2, #13         @ length of our string
    mov R7, #4          @ linux write system call
    svc 0               @ Call linux to print
                        @ Set up the parameters to exit the program
                        @ and then call Linux to do it.
.data
    mov R0, #0  @ Use 0 return code
    mov R7, #1  @ Service command code 1
                @ terminates this program
    svc 0       @ Call linux to terminate

helloworld: .ascii "Hello World!\n"</pre>
            </div>
        </div>
    </div>


    <!-- Feedback Box -->
    <div id="feedback-box" class="fixed hidden right-0 top-1/2 transform -translate-y-1/2 bg-gray-200 dark:bg-[#444444] border-l-4 border-b-4 border-[#E0E0E0] dark:border-[#3B3B3B] rounded-l-xl shadow-lg w-64 p-4 z-50">
        <h2 class="font-bold text-lg dark:text-white text-gray-800 mb-2 text-center">Feedback</h2>
        <textarea id="feedback-text" class="w-full p-2 border rounded-md dark:bg-[#333333] dark:text-steel text-gray-800" rows="4" placeholder="Feedback, corrections, feature ideas, comments, etc."></textarea>
        <button id="submit-feedback" class="mt-2 w-full bg-cs-blue hover:bg-cs-green text-white py-2 px-4 rounded-md">Submit</button>
    </div>

    <!-- Toggle Tab -->
    <button id="feedback-toggle" class="fixed top-1/2 transform -translate-y-1/2 right-0 md:right-64 bg-cs-blue hover:bg-cs-green text-steel rounded-l-md px-1 py-8 shadow-md">
        ||
    </button>

    <!--
    <body class="flex justify-center items-center h-screen bg-gray-100">
        <div class="bg-white p-6 rounded shadow-lg">
            <h1 class="text-2xl mb-4">Report a Problem</h1>
            <form action="/submit_workorder" method="post">
                <textarea name="issue" required class="border p-2 w-full rounded" placeholder="Describe your issue..."></textarea>
                <button type="submit" class="mt-2 bg-blue-500 text-white px-4 py-2 rounded">Submit</button>
            </form>
        </div>
    </body>
    -->

    <script>
        const feedbackBox = document.getElementById('feedback-box');
        const feedbackToggle = document.getElementById('feedback-toggle');
        const feedbackText = document.getElementById('feedback-text');
        const submitFeedback = document.getElementById('submit-feedback');
        
        function checkScreenSize() {
            const isLargerThanMD = window.matchMedia('(min-width: 768px)').matches;

            if (isLargerThanMD) {
                feedbackBox.classList.remove('hidden');
                feedbackToggle.classList.remove('right-0');
                feedbackToggle.classList.add('md:right-64', 'right-64'); // Move next to the feedback box
            } else {
                feedbackBox.classList.add('hidden');
                feedbackToggle.classList.remove('md:right-64', 'right-64');
                feedbackToggle.classList.add('right-0');
            }
        }

        // Initial check when the page loads
        checkScreenSize();

        // Listen for window resize events to detect screen size changes
        window.addEventListener('resize', checkScreenSize);

        // Collapse/Expand Feedback Box
        feedbackToggle.addEventListener('click', () => {
            feedbackBox.classList.toggle('hidden');
            // Adjust the position of the toggle tab
            if (feedbackBox.classList.contains('hidden')) {
                feedbackToggle.classList.remove('md:right-64', 'right-64');
                feedbackToggle.classList.add('right-0'); // Move to the far right
                feedbackBox.classList.remove('md:block');
            } else {
                feedbackToggle.classList.remove('right-0');
                feedbackToggle.classList.add('md:right-64', 'right-64'); // Move next to the feedback box
            }
        });

        // Submit Feedback Function
        const submitFeedbackHandler = () => {
            const feedback = feedbackText.value.trim();
            if (feedback) {
                fetch('/submit-feedback', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ feedback, url: "/" + window.location.pathname.split('/').pop() }), // Ensure `feedback` is a valid variable
            })
            .then(async response => {
                if (response.ok) {
                    // Clear the input and thank the user
                    feedbackText.value = ''; // Ensure `feedbackText` is defined
                    submitFeedback.innerText = 'Thank you!'; // Change the button text
                    submitFeedback.classList.remove('bg-cs-blue'); // Remove original color
                    submitFeedback.classList.add('bg-cs-green'); // Add new color (green for success)

                    setTimeout(() => {
                        submitFeedback.innerText = 'Submit'; // Revert the button text after 3 seconds
                        submitFeedback.classList.remove('bg-cs-green'); // Remove green color
                        submitFeedback.classList.add('bg-cs-blue');
                    }, 3000); // 3000ms = 3 seconds
                } else {
                    // Attempt to read the error message from the server
                    const errorData = await response.json();
                    alert(`Error submitting feedback: ${errorData.details || 'Unknown error occurred'}. Please provide these details to Cooper :)`);
                }
            })
            .catch(error => {
                // Log the error for debugging and notify the user
                console.error('Submission error:', error);
                alert('An error occurred. Please try again.');
            });
            }
        };

        // Submit Feedback on Button Click
        submitFeedback.addEventListener('click', submitFeedbackHandler);

        // Submit Feedback on CMD+Enter or CTRL+Enter
        feedbackText.addEventListener('keydown', (event) => {
            if ((event.metaKey || event.ctrlKey) && event.key === 'Enter') {
                submitFeedbackHandler();
            }
        });
    </script>
</body>
{% endblock %}


<!--
                <h2>Blockquote Example</h2>
                <blockquote class="border-l-4 border-cs-blue italic pl-4 text-cs-green">
                    "This is an example of a blockquote. It's perfect for highlighting important points or quotes."
                </blockquote>

                <h2>Code Snippet Example</h2>
                <p>
                    Below is an example of a simple Python function:
                </p>
                <pre class="dark:bg-gray-600 bg-gray-400 rounded-lg p-4 shadow-2xl overflow-auto">
def greet(name):
    return f"Hello, {name}!"

print(greet("World"))
                </pre>


<code class="bg-cs-blue px-1 rounded shadow-lg text-base">

</code>
-->
