S\{M_i\} = \sum_{k=0}^{3}{S\{M_k|c_i\not=c_k\}}

F(M_i) = \sum_{k=0}^{n}(-1)^{c_i}\cdot{F(C)_k}

F(M_j) = k_1\cdot min(|F(M_i)|, k_2s_{ij})

F = -1 \cdot min(F_x, F_y) \cdot \hat{F}